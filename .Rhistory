q()
library(gapminder)
head(gapminder)
q()
library(gapminder)
cor.test(gapminder$lifeExp, gapminder$gdpPercap)
lmod = lm(data = gapminder, lifeExp~gdpPercap)
summary(lmod)
0.5837062^2
lmod$coefficients
lmod$coefficients[2]^2
cor.test(gapminder$gdpPercap, gapminder$lifeExp)
lmod = lm(data = gapminder, lifeExp~gdpPercap)
summary(lmod)
cor.test(log10(gapminder$gdpPercap), gapminder$lifeExp)
lmod = lm(data = gapminder, lifeExp~log10(gdpPercap))
summary(lmod)
cor.test(gapminder$gdpPercap), gapminder$lifeExp)
lmod = lm(data = gapminder, lifeExp~gdpPercap)
summary(lmod)
cor.test(gapminder$gdpPercap), gapminder$lifeExp)
cor.test(gapminder$gdpPercap, gapminder$lifeExp)
lmod = lm(data = gapminder, lifeExp~gdpPercap)
summary(lmod)
library(tidyverse)
gapminder %>%
ggplot(aes(x = gpdPercap, y = lifeExp)) +
geom_point()
gapminder %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
lmod = lm(data = gapminder, lifeExp~gdpPercap/10000)
summary(lmod)
lmod = lm(data = gapminder, lifeExp~gdpPercap)
summary(lmod)
asia = gapminder %>%
filter(continent == "Asia")
asia %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
cor.test(asia$gdpPercap, asia$lifeExp)
lm_asia = lm(data = asia, lifeExp~gdpPercap)
summary(lm_asia)
?predict
pd_asia = predict(lm_asia, newdata = asia)
head(pd_asia)
pd_asia = predict(lm_asia, newdata = asia, interval = "predict")
head(pd_asia)
asia = gapminder %>%
filter(continent == "Asia", year = 1952)
asia = gapminder %>%
filter(continent == "Asia", year == 1952)
asia %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
cor.test(asia$gdpPercap, asia$lifeExp)
lm_asia = lm(data = asia, lifeExp~gdpPercap)
summary(lm_asia)
pd_asia = predict(lm_asia, newdata = asia, interval = "predict")
head(pd_asia)
euro = gapminder %>%
filter(continent == "Europe", year == 1952)
euro = gapminder %>%
filter(continent == "Europe", year == 1952)
euro %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
cor.test(euro$gdpPercap, euro$lifeExp)
lm_euro = lm(data = euro, lifeExp~gdpPercap)
summary(lm_euro)
pd_euro = predict(lm_euro, newdata = euro, interval = "predict")
head(pd_euro)
asia = gapminder %>%
filter(continent == "Asia", year == 2002)
pd_euro = predict(lm_euro, newdata = asia, interval = "predict")
pd_aisa = predict(lm_euro, newdata = asia, interval = "predict")
head(pd_asia)
head(asia)
pd_aisa = predict(lm_euro, newdata = asia)
head(pd_asia)
pd_aisa = predict(lm_euro, newdata = asia)
head(pd_asia)
pd_aisa = predict(lm_euro, newdata = asia)
head(pd_asia)
asia %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
head(asia)
dim(asia)
dim(pd_asia)
pd_asia = predict(lm_euro, newdata = asia)
head(pd_asia)
df = data.frame(obs = asia$lifeExp, prd = pd_asia)
df %>%
ggplot(aes(obs, prd)) +
geom_point()
df %>%
ggplot(aes(obs, prd)) +
geom_point() +
geom_abline(slope = 1, intercept = 0)
head(df)
df$sqe = (df$obs - df$prd)^2
head(df)
rmse = sqrt(sum(df$sqe)/dim(df)[1])
r,se
rmse
euro2 = gapminder %>%
filter(continent == "Europe", year == 2002)
euro2 %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
pd_euro2 = predict(lm_euro, newdata = euro2)
head(pd_euro2)
df = data.frame(obs = euro2$lifeExp, prd = pd_euro2)
df %>%
ggplot(aes(obs, prd)) +
geom_point() +
geom_abline(slope = 1, intercept = 0)
df$sqe = (df$obs - df$prd)^2
rmse = sqrt(sum(df$sqe)/dim(df)[1])
rmse
pd_asia = predict(lm_euro, newdata = asia)
head(pd_asia)
df = data.frame(obs = asia$lifeExp, prd = pd_asia)
df %>%
ggplot(aes(obs, prd)) +
geom_point() +
geom_abline(slope = 1, intercept = 0)
df$sqe = (df$obs - df$prd)^2
rmse = sqrt(sum(df$sqe)/dim(df)[1])
rmse
tway = lm(lifeExp ~ continent*gdpPercap, data = gapminder)
summary(tway)
q()
library(gapminder)
library(tidyverse)
euro = gapminder %>%
filter(continent == "Europe", year == 1952)
euro %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
cor.test(euro$gdpPercap, euro$lifeExp)
lm_euro = lm(data = euro, lifeExp~gdpPercap)
summary(lm_euro)
asia = gapminder %>%
filter(continent == "Asia", year == 2002)
asia %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
pd_asia = predict(lm_euro, newdata = asia)
head(pd_asia)
df = data.frame(obs = asia$lifeExp, prd = pd_asia)
df %>%
ggplot(aes(obs, prd)) +
geom_point() +
geom_abline(slope = 1, intercept = 0)
df$sqe = (df$obs - df$prd)^2
rmse = sqrt(sum(df$sqe)/dim(df)[1])
rmse
tway = lm(lifeExp ~ continent*gdpPercap, data = gapminder)
summary(tway)
# two-way anova
eurasia = cbind(euro, asia)
euro
asia
# two-way anova
eurasia = rbind(euro, asia)
tway = lm(lifeExp ~ continent*gdpPercap, data = gapminder)
summary(tway)
tway = lm(lifeExp ~ continent*gdpPercap, data = eurasia)
summary(tway)
eurasia %>%
group_by(continent) %>%
ggplot(aes(gdpPercap, lifeExp)) +
geom_point() +
stat_smooth(method = "lm")
eurasia %>%
group_by(continent) %>%
ggplot(aes(gdpPercap, lifeExp)) +
geom_point() +
stat_smooth(method = "lm") +
facet_wrap(~continent)
eurasia %>%
ggplot(aes(gdpPercap, lifeExp)) +
geom_point() +
stat_smooth(method = "lm") +
facet_wrap(~continent)
q()
library(gapminder)
library(tidyverse)
gapminder %>%
filter(year == 1952) %>%
filte(continent == "Europe") -> temp
gapminder %>%
filter(year == 1952) %>%
filter(continent == "Europe") -> temp
gapminder %>%
filter(year == 1952) %>%
filter(continent == "Europe") -> euro
euro %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
cor.test(euro$lifeExp, euro$gdpPercap)
lmod = lm(lifeExp ~ gdpPercap, data = euro)
summary(lmod)
gapminder %>%
filter(year == 1952) %>%
filter(continent %in% c("Europe", "Asia")) -> eurasia
eurasia %>%
ggplot(aes(gdpPercap, lifeExp, col = continent)) +
geom_point() +
stat_smooth(method = "lm")
gapminder %>%
filter(year == 1952) %>%
filter(continent %in% c("Europe", "Asia")) %>%
filter(gdpPercap < 30000) -> eurasia
eurasia %>%
ggplot(aes(gdpPercap, lifeExp, col = continent)) +
geom_point() +
stat_smooth(method = "lm")
tway_mod = lm(lifeExp ~ gdpPercap * continent)
tway_mod = lm(lifeExp ~ gdpPercap * continent, data = eurasia)
summary(tway_mod)
q()
library(gapminder)
library(tidyverse)
gapminder %>%
filter(year == 1952) %>%
filter(continent == "Europe") -> euro
euro %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point()
cor.test(euro$lifeExp, euro$gdpPercap)
lmod = lm(lifeExp ~ gdpPercap, data = euro)
summary(lmod)
gapminder %>%
filter(year == 1952) %>%
filter(continent %in% c("Europe", "Asia")) %>%
filter(gdpPercap < 30000) -> eurasia
eurasia %>%
ggplot(aes(gdpPercap, lifeExp, col = continent)) +
geom_point() +
stat_smooth(method = "lm")
tway_mod = lm(lifeExp ~ gdpPercap * continent, data = eurasia)
summary(tway_mod)
asia = gapminder %>%
filter(year == 2002) %>%
filter(continent == "Asia")
prd = predict(lmod, newdata = asia)
prd
obs = asia$lifeExp
df = data.frame(obs, prd)
ggplot(df, aes(x=obs, y=prd)) +
geom_point() +
geom_abline(intercept = 0, slope = 1)
library(broom)
gapminder %>%
group_by(country) %>%
nest() -> temp
temp
gapminder
temp$data[[1]]
temp
gapminder %>%
group_by(country) %>%
nest() %>%
mutate(lmod = map(.x = data, .f = ~lm(lifeExp~gdpPercap, data = .x))) -> temp
tmep
temp
summary(temp$lmod[[1]])
gapminder %>%
group_by(country) %>%
nest() %>%
mutate(lmod = map(.x = data, .f = ~lm(lifeExp~gdpPercap, data = .x))) %>%
mutate(fit = map(lmod, ~glance(.x))) -> temp
tmep
temp
temp$fit[[1]]
gapminder %>%
group_by(country) %>%
nest() %>%
mutate(lmod = map(.x = data, .f = ~lm(lifeExp~gdpPercap, data = .x))) %>%
mutate(fit = map(lmod, ~glance(.x))) %>%
select(country, r.squared) -> temp
rlang::last_error()
gapminder %>%
group_by(country) %>%
nest() %>%
mutate(lmod = map(.x = data, .f = ~lm(lifeExp~gdpPercap, data = .x))) %>%
mutate(fit = map(lmod, ~glance(.x))) %>%
unnest(fit) -> temp
temp
gapminder %>%
group_by(country) %>%
nest() %>%
mutate(lmod = map(.x = data, .f = ~lm(lifeExp~gdpPercap, data = .x))) %>%
mutate(fit = map(lmod, ~glance(.x))) %>%
unnest(fit) %>%
select(country, r.squared) -> temp
temp
temp %>%
arrange(r.squared) -> df
df[1:10,]
temp %>%
arrange(desc(r.squared)) -> df
df[1:10,]
q()
sessionInfo()
library(tidyverse)
sessionInfo()
q()
library(googlesheets4)
clnic = read_sheet("https://docs.google.com/spreadsheets/d/15Cctp_a-w_8MOMnQnGr74HHqFgVG-74jqrs_azjGMgE/edit?usp=sharing")
head(clinic)
head(clinic)
head(clnic)
mir = read_sheet("https://docs.google.com/spreadsheets/d/1dkm_47r5QU35rIqVNQ-TUPl5vPsqMOQvH9Ke27ZM1Jg/edit?usp=sharing")
length(unique(clnic$study_id))
head(mir)
?read_sheet
mir = read_sheet("https://docs.google.com/spreadsheets/d/1dkm_47r5QU35rIqVNQ-TUPl5vPsqMOQvH9Ke27ZM1Jg/edit?usp=sharing", na = NA)
mir = read_sheet("https://docs.google.com/spreadsheets/d/1dkm_47r5QU35rIqVNQ-TUPl5vPsqMOQvH9Ke27ZM1Jg/edit?usp=sharing", na = "NA")
head(mir)
length(unique(mir$study_id))
nfl = read_sheet("https://docs.google.com/spreadsheets/d/1SV1ez6eDIVfQHUmQFz07ZFLNXaX93rGIWyn7ODJMQAg/edit?usp=sharing")
head(nfl)
nfl = read_sheet("https://docs.google.com/spreadsheets/d/1SV1ez6eDIVfQHUmQFz07ZFLNXaX93rGIWyn7ODJMQAg/edit?usp=sharing", col_types = c("chr", "chr", "chr", "factor", "chr", "dbl", "dbl", "dbl", "chr"))
nfl = read_sheet("https://docs.google.com/spreadsheets/d/1SV1ez6eDIVfQHUmQFz07ZFLNXaX93rGIWyn7ODJMQAg/edit?usp=sharing", col_types = "cccccdddc")
head(nfl)
intersect(clnic$study_id, mir$study_id, nfl$study_id)
st_id = intersect(intersect(clnic$study_id, mir$study_id), nfl$study_id)
st_id
length(unique(nfl$study_id))
head(nfl)
length(unique(nfl[nfl$gr == "als",]$study_id))
head(mir)
length(unique(st_id))
length(unique(mir[mir$group == "ALS",]$study_id))
head(clnic)
length(unique(mir$study_id))
clnic2 = clnic %>%
filter(!is.na(est_slope))
clnic2 = clnic %>%
filter(est_slope !== NA)
head(clnic)
clnic = read_sheet("https://docs.google.com/spreadsheets/d/15Cctp_a-w_8MOMnQnGr74HHqFgVG-74jqrs_azjGMgE/edit?usp=sharing", na = "NA")
clnic2 = clnic %>%
filter(!is.na(est_slope))
head(clnic)
library(tidyverse)
clnic2 = clnic %>%
filter(!is.na(est_slope))
st_id = intersect(intersect(clnic2$study_id, mir$study_id), nfl$study_id) #76
length(unique(clnic2$study_id)) # als 79
length(st_id)
st_id
write.csv(st_id, "study_id_cohort1.csv", row.names = F, quote = F)
getwd()
?write.csv
q()\
q()
knitr::opts_chunk$set(echo = TRUE)
```{r class.source = 'fold-show' pressure}
setwd("C:/Users/BRMH/Dropbox/Github/sdg")
plastic = read.csv("compt_plastic_wst.csv")
head(plastic)
plastic = read.csv("compt_plastic_wst.csv", fileEncoding="UTF-8-BOM")
head(plastic)
plastic = read.csv("compt_plastic_wst.csv", fileEncoding="UTF-8-BOM", header = T)
head(plastic)
plastic = read.csv("compt_plastic_wst.csv", fileEncoding="UTF-8-BOM")
head(plastic)
plastic = read.csv("compt_plastic_wst.csv")
head(plastic)
plastic = read.csv("compt_plastic_wst.csv")
head(plastic)
str(plastic)
library(tidyverse)
plastic_long = gather(plastic, key = "year", value = "plastic", X1993:X2017)
head(plastic_long)
plastic_long$year = str_remove(plastic_long$year, "^X")
head(plastic_long)
?gather
library(tidyr)
str(plastic_long)
temp = gather(plastic, key = "year", value = "plastic", X1993:X2017)
temp = gather(plastic, key = "year", value = "plastic", X1993:X2017)
temp$year = str_remove(temp$year, "^X")
str(temp)
temp$year = as.numeric(temp$year)
str(temp)
plstic <- temp
library(ggplot2)
ggplot(plastic, aes(x = year, y = plastic)) +
geom_point()
plstic <- temp
ggplot(plastic, aes(x = year, y = plastic)) +
geom_point()
head(plastic)
plastic <- temp
ggplot(plastic, aes(x = year, y = plastic)) +
geom_point()
hdi = read.csv("hdi_human_development_index.csv")
head(hdi)
hdi = read.csv("hdi_human_development_index.csv")
head(hdi)
temp = gather(hdi, key = "year", value = "hdindex", X1990:X2021)
temp$year = as.numeric(temp$year)
hdi <- temp
head(hdi)
temp = gather(hdi, key = "year", value = "hdindex", X1990:X2021)
temp$year = str_remove(temp$year, "^X")
temp$year = as.numeric(temp$year)
hdi <- temp
head(hdi)
hdi = read.csv("hdi_human_development_index.csv")
temp = gather(hdi, key = "year", value = "hdindex", X1990:X2021)
temp$year = str_remove(temp$year, "^X")
temp$year = as.numeric(temp$year)
hdi <- temp
head(hdi)
library(dplyr)
plastic_hdi = plastic %>%
inner_join(hdi, by = c("country", "year"))
head(plastic_hdi)
ph = plastic_hdi[complete.cases(plastic_hdi),]
head(ph)
ggplot(ph, aes(x = hdi, y=plastic)) +
geom_point()
ggplot(ph, aes(x = hdindex, y=plastic)) +
geom_point()
p = ggplot(ph, aes(x = hdindex, y=plastic)) +
geom_point()
library(plotly)
library(ggplotly)
ggplotly(p)
p = ggplot(ph, aes(x = hdindex, y=plastic, color = country)) +
geom_point()
ggplotly(p)
p = ggplot(ph, aes(x = hdindex, y=plastic, color = country)) +
geom_point() +
theme(legend.position = "none")
ggplotly(p)
wn = read.csv("wn_bothhouses_c.csv")
head(wn)
temp = gather(wn, key = "year", value = "wnparl", X1945:X2021)
temp$year = str_remove(temp$year, "^X")
temp$year = as.numeric(temp$year)
wn <- temp
phw = ph %>%
inner_join(wn, by = c("country", "year"))
head(phw)
phw = phw[complete.cases(phw),]
p = ggplot(phw, aes(x = hdindex, y=plastic, color = wnparl)) +
geom_point() +
scale_color_continuous()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl)) +
geom_point() +
scale_size_continuous()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl, color = wnparl)) +
geom_point() +
scale_size_continuous()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl)) +
geom_point(alpha = 0.5) +
scale_size_continuous()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl, color = country)) +
geom_point(alpha = 0.5) +
scale_size_continuous()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl, color = country)) +
geom_point(alpha = 0.5) +
scale_size_continuous() +
theme(legend.position = "none")
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl, shape = country)) +
geom_point(alpha = 0.5) +
scale_size_continuous() +
theme(legend.position = "none")
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl)) +
geom_point(alpha = 0.5) +
scale_size_continuous() +
theme(legend.position = "none")
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl)) +
geom_point(alpha = 0.5) +
scale_size_continuous()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl)) +
geom_point(alpha = 0.5) +
scale_size_manual()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl)) +
geom_point(alpha = 0.5) +
scale_size_discrete()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, size = wnparl)) +
geom_point(alpha = 0.5) +
scale_size_binned()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, color = wnparl)) +
geom_point(alpha = 0.5) +
scale_color_continuous()
ggplotly(p)
p = ggplot(phw, aes(x = hdindex, y=plastic, color = wnparl, size = wnparl)) +
geom_point(alpha = 0.5) +
scale_color_continuous()
ggplotly(p)
q()
